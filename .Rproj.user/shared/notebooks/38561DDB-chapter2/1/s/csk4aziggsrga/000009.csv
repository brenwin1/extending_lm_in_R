"0",""
"0","# --- plot logistic regression; on probability scale "
"0","df <- tibble(x = lin_pred, # eta = \hat{\beta_0} + \hat{\beta_1}.x1 + \hat{\beta_2}.x2"
"0","       y_hat = prob_pred, # y_hat = exp(eta) / (1 + exp(eta)) *transform log(odds) to probability scale"
"0","       raw_resid = wcgs$y - prob_pred, # y - y_hat"
"0","       actual_y = wcgs$y) # 0 & 1's"
"0",""
"0","df %>% "
"0","  ggplot() +"
"0","  # fitted logistic regression"
"0","  geom_line(aes(x = x,"
"0","                y = y_hat),"
"0","            size = 1.5) +"
"0","  # actual y values (0 & 1) "
"0","  geom_point(aes(x = x,"
"0","                 y = actual_y,"
"0","                 colour = factor(actual_y)),"
"0","             alpha = 0.8) +"
"0","  # draw residual line (from y to y_hat); for each x value"
"0","  geom_segment(aes(x = x,"
"0","                   y = y_hat,"
"0","                   xend = x,"
"0","                   yend = actual_y,"
"0","                   colour = factor(actual_y)),"
"0","               alpha = 0.1) +"
"0","  theme_bw() +"
"0","  # colour chd (red)// no chd(blue)"
"0","  scale_colour_manual(""chd"","
"0","                      values = c(""blue"", ""red""),"
"0","                      labels = c(""0: no chd"", ""1: chd"")) +"
"0","	# add axes labels & title "
"0","  labs(x = latex2exp::TeX(""$\\eta = \\beta_0 + \\beta_1.height + \\beta_2.cigs$""),"
"0","       y = latex2exp::TeX(""$\\hat{y} = \\frac{e^{\\eta}}{1+e^{\\eta}}$"")) +"
"0","  ggtitle(""fitted logistic regression on probability scale"")"
